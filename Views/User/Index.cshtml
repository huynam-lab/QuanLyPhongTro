@using PagedList;
@using PagedList.Mvc;

@model IPagedList<QuanLyPhongTro.Models.Phong_Tro>
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
<link href="~/Assets/Css/Index.css" rel="stylesheet" />
<div class="container mt-4">
    <div class="row">

        <div class="col-lg-8">

            <h2 class="h4">Kênh thông tin Phòng Trọ số 1 Việt Nam</h2>
            <p class="text-muted">Có 77.541 tin đang cho thuê</p>



            <ul class="nav nav-tabs mb-3">
                <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="#">Đề xuất</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Mới đăng</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Có video</a>
                </li>
            </ul>
            @foreach (var item in Model)
            {
                var userFavorites = (List<int>)ViewBag.UserFavorites ?? new List<int>();
                var isFavorited = userFavorites.Contains(item.ID_Phong_Tro);
                var heartIconClass = isFavorited ? "bi-heart-fill" : "bi-heart";
                var activeClass = isFavorited ? "active" : "";

                var hinhAnh = item.Hinh_Anh.ToList();
                var avatarNguoiDang = (item.Tai_Khoan != null && !string.IsNullOrEmpty(item.Tai_Khoan.Avata)) ? item.Tai_Khoan.Avata : "~/Assets/Images/Avatar/avatar-mac-dinh.jpg";


                if (item.ID_LoaiTin == 1)
                {
                    <div class="card shadow-sm mb-4 border-0">

                        <div class="p-2">
                            <div class="media-grid4">
                                <!-- ẢNH LỚN BÊN TRÁI -->
                                <div class="media-left">
                                    <a href="@Url.Action("ChiTiet", "User", new { id = item.ID_Phong_Tro })">
                                        <img src="@(hinhAnh.Count > 0 ? Url.Content("~/Kho/Img/" + hinhAnh[0].Url_Anh) : Url.Content("~/Kho/Img/placeholder.jpg"))"
                                             alt="@item.Ten_Phong" loading="lazy" />
                                    </a>
                                        <div class="image-count-overlay">
                                            <i class="bi bi-camera-fill"></i> @hinhAnh.Count
                                        </div>
                                </div>

                                <!-- PHẢI: 1 ẢNH TRÊN -->
                                <div class="media-rtop">
                                    <img src="@(hinhAnh.Count > 1 ? Url.Content("~/Kho/Img/" + hinhAnh[1].Url_Anh) : Url.Content("~/Kho/Img/placeholder.jpg"))"
                                         alt="Ảnh phụ 1" loading="lazy" />
                                </div>

                                <!-- PHẢI: 2 ẢNH DƯỚI -->
                                <div class="media-rb">
                                    <img src="@(hinhAnh.Count > 2 ? Url.Content("~/Kho/Img/" + hinhAnh[2].Url_Anh) : Url.Content("~/Kho/Img/placeholder.jpg"))"
                                         alt="Ảnh phụ 2" loading="lazy" />
                                    <img src="@(hinhAnh.Count > 3 ? Url.Content("~/Kho/Img/" + hinhAnh[3].Url_Anh) : Url.Content("~/Kho/Img/placeholder.jpg"))"
                                         alt="Ảnh phụ 3" loading="lazy" />
                                </div>
                            </div>
                        </div>
                        <div class="card-body pt-2">
                            <div class="mb-1">
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                            </div>

                            <h5 class="card-title text-danger fw-bold" style="font-size: 1.1rem;">
                                <a href="@Url.Action("ChiTiet", "User", new { id = item.ID_Phong_Tro })" class="post-title-link">
                                    @item.Ten_Phong
                                </a>
                            </h5>
                            <p class="card-text mb-1">
                                <span class="fw-bold text-success fs-5">@(item.Gia_Ca.HasValue ? String.Format("{0:N0}", item.Gia_Ca.Value) : "Thỏa thuận")/tháng</span>
                                <span class="mx-2">·</span>
                                <span>@item.Dien_Tich m²</span>
                                <span class="mx-2">·</span>
                                <span>@(item.Khu_Vuc != null ? item.Khu_Vuc.Ten_KV : "...")</span>
                            </p>
                            <p class="card-text text-muted post-description">
                                @item.Mo_Ta
                            </p>
                        </div>

                        <div class="card-footer bg-white d-flex justify-content-between align-items-center border-top-0 pt-0">
                            <div class="d-flex align-items-center">
                                <img style="height:30px;width:30px" src="@Url.Content(avatarNguoiDang)" class="rounded-circle" alt="Avatar">
                                <div class="ms-2">
                                    <span class="fw-bold d-block" style="font-size: 0.9rem;">@(item.Tai_Khoan != null ? item.Tai_Khoan.Name : "...")</span>
                                    <small class="text-muted">@(item.Ngay_Dang.HasValue ? item.Ngay_Dang.Value.ToString("dd/MM/yyyy") : "...")</small>
                                </div>
                            </div>

                            <div class="post-actions">
                                <a href="tel:@(item.Tai_Khoan != null ? item.Tai_Khoan.SDT : "#")" class="btn btn-success" style="font-size: 0.9rem; font-weight: bold;">
                                    <i class="bi bi-telephone-fill me-1"></i> @(item.Tai_Khoan != null ? item.Tai_Khoan.SDT : "...")
                                </a>
                                <a href="#" class="btn-favorite @activeClass" data-post-id="@item.ID_Phong_Tro">
                                    <i class="bi @heartIconClass"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                }
                else if (item.ID_LoaiTin == 2)
                {
                    <div class="card shadow-sm mb-4 border-0">
                        <div class="row g-0">

                            <div class="col-md-5">
                                <a href="@Url.Action("ChiTiet", "User", new { id = item.ID_Phong_Tro })" class="post-image-link">
                                    <div class="gallery-3-leftBig">
                                        <div class="g3-big">
                                            <img src="@(hinhAnh.Count > 0 ? Url.Content("~/Kho/Img/" + hinhAnh[0].Url_Anh) : Url.Content("~/Kho/Img/placeholder.jpg"))"
                                                 alt="@item.Ten_Phong" loading="lazy" />
                                        </div>
                                        <div class="g3-right1">
                                            <img src="@(hinhAnh.Count > 1 ? Url.Content("~/Kho/Img/" + hinhAnh[1].Url_Anh) : Url.Content("~/Kho/Img/placeholder.jpg"))"
                                                 alt="Ảnh 2" loading="lazy" />
                                        </div>
                                        <div class="g3-right2">
                                            <img src="@(hinhAnh.Count > 2 ? Url.Content("~/Kho/Img/" + hinhAnh[2].Url_Anh) : Url.Content("~/Kho/Img/placeholder.jpg"))"
                                                 alt="Ảnh 3" loading="lazy" />
                                        </div>

                                        <div class="image-count-overlay">
                                            <i class="bi bi-camera-fill"></i> @hinhAnh.Count
                                        </div>
                                    </div>
                                </a>
                            </div>

                            <div class="col-md-7">
                                <div class="card-body d-flex flex-column h-100 p-3">
                                    <div>
                                        <div class="mb-1">
                                            <i class="bi bi-star-fill text-warning"></i>
                                            <i class="bi bi-star-fill text-warning"></i>
                                            <i class="bi bi-star-fill text-warning"></i>
                                            <i class="bi bi-star-fill text-warning"></i>
                                        </div>
                                        <h5 class="card-title fw-bold" style="color: #c90076; font-size: 1.1rem; line-height: 1.4;">
                                            <a href="@Url.Action("ChiTiet", "User", new { id = item.ID_Phong_Tro })" class="post-title-link">
                                                @item.Ten_Phong
                                            </a>
                                        </h5>
                                    </div>
                                    <div class="my-3">
                                        <p class="card-text mb-1">
                                            <span class="fw-bold text-success fs-5">@(item.Gia_Ca.HasValue ? String.Format("{0:N0}", item.Gia_Ca.Value) : "Thỏa thuận")/tháng</span>
                                            <span class="mx-2">·</span>
                                            <span>@item.Dien_Tich m²</span>
                                        </p>
                                        <p class="card-text text-muted mb-2" style="font-size: 0.95rem;">
                                            <i class="bi bi-geo-alt-fill me-1"></i>@(item.Khu_Vuc != null ? item.Khu_Vuc.Ten_KV : "...")
                                        </p>
                                        <p class="card-text text-muted post-description">
                                            @item.Mo_Ta
                                        </p>
                                    </div>
                                    <div class="mt-auto">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div class="d-flex align-items-center">
                                                <img style="height:40px; width:40px" src="@Url.Content(avatarNguoiDang)" class="rounded-circle" alt="Avatar">
                                                <div class="ms-2">
                                                    <span class="fw-bold d-block" style="font-size: 0.9rem;">@(item.Tai_Khoan != null ? item.Tai_Khoan.Name : "...")</span>
                                                    <small class="text-muted">@(item.Ngay_Dang.HasValue ? item.Ngay_Dang.Value.ToString("dd/MM/yyyy") : "...")</small>
                                                </div>
                                            </div>
                                            <div class="d-flex align-items-center">
                                                <a href="tel:@(item.Tai_Khoan != null ? item.Tai_Khoan.SDT : "#")" class="btn btn-success" style="font-size: 0.9rem; font-weight: bold;">
                                                    <i class="bi bi-telephone-fill me-1"></i> @(item.Tai_Khoan != null ? item.Tai_Khoan.SDT : "...")
                                                </a>
                                                <a href="#" class="btn-favorite @activeClass" data-post-id="@item.ID_Phong_Tro">
                                                    <i class="bi @heartIconClass"></i>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                }
                else if (item.ID_LoaiTin == 3)
                {
                    <div class="card shadow-sm mb-4 border-0">
                        <div class="row g-0 align-items-start">
                            <div class="col-md-5 p-3 align-self-start">
                                <a href="@Url.Action("ChiTiet", "User", new { id = item.ID_Phong_Tro })" class="post-image-link">
                                    <div class="pt-img">
                                        <img src="@(hinhAnh.Count > 0 ? Url.Content("~/Kho/Img/" + hinhAnh[0].Url_Anh) : Url.Content("~/Kho/Img/placeholder.jpg"))"
                                             alt="@item.Ten_Phong" loading="lazy" />
                                        <div class="pt-count"><i class="bi bi-camera-fill"></i>@hinhAnh.Count</div>
                                    </div>
                                </a>
                            </div>

                            <div class="col-md-7 d-flex flex-column">
                                <div class="card-body py-3">
                                    <div class="mb-1">
                                        <i class="bi bi-star-fill text-warning"></i>
                                        <i class="bi bi-star-fill text-warning"></i>
                                        <i class="bi bi-star-fill text-warning"></i>
                                    </div>
                                    <h5 class="pt-title--orange"><a href="@Url.Action("ChiTiet", "User", new { id = item.ID_Phong_Tro })" class="post-title-link">
    @item.Ten_Phong
</a></h5>

                                    <p class="mb-1">
                                        <span class="pt-price">
                                            @(item.Gia_Ca.HasValue ? string.Format("{0:0.#} triệu/tháng", (decimal)item.Gia_Ca.Value / 1_000_000M) : "Thỏa thuận")
                                        </span>
                                        <span class="mx-2">·</span><span>@item.Dien_Tich m²</span>
                                    </p>

                                    <p class="pt-meta">
                                        <i class="bi bi-geo-alt-fill me-1"></i>@(item.Khu_Vuc?.Ten_KV ?? "...")
                                    </p>

                                    <p class="pt-desc post-description">@item.Mo_Ta</p>
                                </div>

                                <div class="pt-footer d-flex justify-content-between align-items-center px-3 pb-3">
                                    <div class="d-flex align-items-center">
                                        <img class="avatar" src="@Url.Content(avatarNguoiDang)" alt="Avatar">
                                        <div class="ms-2">
                                            <span class="fw-bold d-block" style="font-size:.92rem;">@(item.Tai_Khoan?.Name ?? "...")</span>
                                            <small class="text-muted">@(item.Ngay_Dang?.ToString("dd/MM/yyyy") ?? "...")</small>
                                        </div>
                                    </div>
                                    <a href="#" class="btn-favorite @activeClass" data-post-id="@item.ID_Phong_Tro">
                                        <i class="bi @heartIconClass"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>

                }
                else if (item.ID_LoaiTin == 4)
                {
                    <div class="card listing-card">
                        <div class="row g-0">
                            <!-- ẢNH -->
                            <div class="col-md-5">
                                <a href="@Url.Action("ChiTiet", "User" ,new { id = item.ID_Phong_Tro })" class="post-image-link">
                                    <div class="lc-thumb">
                                        <img src="@(hinhAnh.Count > 0 ? Url.Content("~/Kho/Img/" + hinhAnh[0].Url_Anh) : Url.Content("~/Kho/Img/placeholder.jpg"))"
                                             alt="@item.Ten_Phong">
                                        @* (tuỳ chọn) icon play nếu là video *@
                                        @* <div class="lc-play"><i class="bi bi-play-circle-fill"></i></div> *@
                                        <div class="lc-count"><i class="bi bi-camera-fill"></i>@hinhAnh.Count</div>
                                    </div>
                                </a>
                            </div>

                            <!-- NỘI DUNG -->
                            <div class="col-md-7">
                                <div class="card-body d-flex flex-column h-100 p-3">
                                    <div class="mb-1">
                                        <i class="bi bi-star-fill text-warning"></i>
                                        <i class="bi bi-star-fill text-warning"></i>
                                    </div>

                                    <a class="lc-title" href="@Url.Action("ChiTiet", "User", new { id = item.ID_Phong_Tro })">@item.Ten_Phong</a>
                                    <div class="my-2">
                                        <p class="mb-1">
                                            <span class="lc-price">@(item.Gia_Ca.HasValue ? String.Format("{0:N0}", item.Gia_Ca.Value) : "Thỏa thuận")/tháng</span>
                                            <span class="lc-dot">•</span>
                                            <span>@item.Dien_Tich m²</span>
                                        </p>
                                        <p class="lc-meta mb-2">
                                            <i class="bi bi-geo-alt-fill"></i>@(item.Khu_Vuc != null ? item.Khu_Vuc.Ten_KV : "...")
                                        </p>
                                    </div>

                                    <p class="lc-desc post-description">@item.Mo_Ta</p>
                                    <div class="lc-footer">
                                        <div class="lc-author">
                                            <img src="@Url.Content(avatarNguoiDang)" class="lc-avatar" alt="Avatar">
                                            <div>
                                                <span class="lc-name">@(item.Tai_Khoan != null ? item.Tai_Khoan.Name : "...")</span>
                                                <div class="lc-time">@(item.Ngay_Dang?.ToString("dd/MM/yyyy") ?? "...")</div>
                                            </div>
                                        </div>
                                        <a href="#" class="btn-favorite @activeClass" data-post-id="@item.ID_Phong_Tro">
                                            <i class="bi @heartIconClass"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                }
                else if (item.ID_LoaiTin == 5)
                {
                    <div class="card listing-card">
                        <div class="row g-0">
                            <!-- ẢNH -->
                            <div class="col-md-5">
                                <a href="@Url.Action("ChiTiet", "User", new { id = item.ID_Phong_Tro })" class="post-image-link">
                                    <div class="lc-thumb">
                                        <img src="@(hinhAnh.Count > 0 ? Url.Content("~/Kho/Img/" + hinhAnh[0].Url_Anh) : Url.Content("~/Kho/Img/placeholder.jpg"))"
                                             alt="@item.Ten_Phong">
                                        <div class="lc-count"><i class="bi bi-camera-fill"></i>@hinhAnh.Count</div>
                                    </div>
                                </a>
                            </div>

                            <!-- NỘI DUNG -->
                            <div class="col-md-7">
                                <div class="card-body d-flex flex-column h-100 p-3">
                                    <a class="lc-title" href="@Url.Action("ChiTiet", "User", new { id = item.ID_Phong_Tro })">@item.Ten_Phong</a>
                                    <div class="my-2">
                                        <p class="mb-1">
                                            <span class="lc-price">@(item.Gia_Ca.HasValue ? String.Format("{0:N0}", item.Gia_Ca.Value) : "Thỏa thuận")/tháng</span>
                                            <span class="lc-dot">•</span>
                                            <span>@item.Dien_Tich m²</span>
                                        </p>
                                        <p class="lc-meta mb-2">
                                            <i class="bi bi-geo-alt-fill"></i>@(item.Khu_Vuc != null ? item.Khu_Vuc.Ten_KV : "...")
                                        </p>
                                    </div>

                                    <p class="lc-desc post-description">@item.Mo_Ta</p>
                                    <div class="lc-footer">
                                        <div class="lc-time">@(item.Ngay_Dang.HasValue ? item.Ngay_Dang.Value.ToString("H' giờ trước'") : "Hôm nay")</div>
                                        <a href="#" class="btn-favorite @activeClass" data-post-id="@item.ID_Phong_Tro">
                                            <i class="bi @heartIconClass"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            }
        <div class="pagination-container d-flex justify-content-center">
            @Html.PagedListPager(Model, page => Url.Action("Index",
                    new
                    {
                        page = page,
                        minPrice = ViewBag.CurrentMinPrice,
                        maxPrice = ViewBag.CurrentMaxPrice,
                        minArea = ViewBag.CurrentMinArea,
                        maxArea = ViewBag.CurrentMaxArea
                    }),
                    new PagedListRenderOptions
                    {
                        UlElementClasses = new[] { "pagination" },
                        LiElementClasses = new[] { "page-item" },
                        LinkToPreviousPageFormat = "« Trang trước",
                        LinkToNextPageFormat = "Trang sau »"
                    })
        </div>
        </div>


        <div class="col-lg-4">

            <div class="card mb-3">
                <div class="card-body pb-1">

                    <h6 class="fw-bold mb-2" style="font-size: 1rem;">Xem theo khoảng giá</h6>
                    <div class="row g-1">
                        <div class="col-6">
                            <a href="@Url.Action("Index", new { minPrice = (int?)null, maxPrice = (int?)null, minArea = ViewBag.CurrentMinArea, maxArea = ViewBag.CurrentMaxArea })" class="sidebar-filter-link">Tất cả</a>
                        </div>
                        <div class="col-6">
                            <a href="@Url.Action("Index", new { minPrice = (int?)null, maxPrice = 1000000, minArea = ViewBag.CurrentMinArea, maxArea = ViewBag.CurrentMaxArea })" class="sidebar-filter-link">Dưới 1 triệu</a>
                        </div>
                        <div class="col-6">
                            <a href="@Url.Action("Index", new { minPrice = 1000000, maxPrice = 2000000, minArea = ViewBag.CurrentMinArea, maxArea = ViewBag.CurrentMaxArea })" class="sidebar-filter-link">Từ 1 - 2 triệu</a>
                        </div>
                        <div class="col-6">
                            <a href="@Url.Action("Index", new { minPrice = 2000000, maxPrice = 3000000, minArea = ViewBag.CurrentMinArea, maxArea = ViewBag.CurrentMaxArea })" class="sidebar-filter-link">Từ 2 - 3 triệu</a>
                        </div>
                        <div class="col-6">
                            <a href="@Url.Action("Index", new { minPrice = 3000000, maxPrice = 5000000, minArea = ViewBag.CurrentMinArea, maxArea = ViewBag.CurrentMaxArea })" class="sidebar-filter-link">Từ 3 - 5 triệu</a>
                        </div>
                        <div class="col-6">
                            <a href="@Url.Action("Index", new { minPrice = 5000000, maxPrice = 7000000, minArea = ViewBag.CurrentMinArea, maxArea = ViewBag.CurrentMaxArea })" class="sidebar-filter-link">Từ 5 - 7 triệu</a>
                        </div>
                        <div class="col-6">
                            <a href="@Url.Action("Index", new { minPrice = 7000000, maxPrice = 10000000, minArea = ViewBag.CurrentMinArea, maxArea = ViewBag.CurrentMaxArea })" class="sidebar-filter-link">Từ 7 - 10 triệu</a>
                        </div>
                        <div class="col-6">
                            <a href="@Url.Action("Index", new { minPrice = 10000000, maxPrice = 15000000, minArea = ViewBag.CurrentMinArea, maxArea = ViewBag.CurrentMaxArea })" class="sidebar-filter-link">Từ 10 - 15 triệu</a>
                        </div>
                        <div class="col-6">
                            <a href="@Url.Action("Index", new { minPrice = 15000000, maxPrice = (int?)null, minArea = ViewBag.CurrentMinArea, maxArea = ViewBag.CurrentMaxArea })" class="sidebar-filter-link">Trên 15 triệu</a>
                        </div>
                    </div>

                    <h6 class="fw-bold mb-2 mt-3" style="font-size: 1rem;">Xem theo diện tích</h6>
                    <div class="row g-1 mb-2">
                        <div class="col-6">
                            <a href="@Url.Action("Index", new { minPrice = ViewBag.CurrentMinPrice, maxPrice = ViewBag.CurrentMaxPrice, minArea = (int?)null, maxArea = (int?)null })" class="sidebar-filter-link">Tất cả</a>
                        </div>
                        <div class="col-6">
                            <a href="@Url.Action("Index", new { minPrice = ViewBag.CurrentMinPrice, maxPrice = ViewBag.CurrentMaxPrice, minArea = (int?)null, maxArea = 20 })" class="sidebar-filter-link">Dưới 20 m²</a>
                        </div>
                        <div class="col-6">
                            <a href="@Url.Action("Index", new { minPrice = ViewBag.CurrentMinPrice, maxPrice = ViewBag.CurrentMaxPrice, minArea = 20, maxArea = 30 })" class="sidebar-filter-link">Từ 20 - 30m²</a>
                        </div>
                        <div class="col-6">
                            <a href="@Url.Action("Index", new { minPrice = ViewBag.CurrentMinPrice, maxPrice = ViewBag.CurrentMaxPrice, minArea = 30, maxArea = 50 })" class="sidebar-filter-link">Từ 30 - 50m²</a>
                        </div>
                        <div class="col-6">
                            <a href="@Url.Action("Index", new { minPrice = ViewBag.CurrentMinPrice, maxPrice = ViewBag.CurrentMaxPrice, minArea = 50, maxArea = 70 })" class="sidebar-filter-link">Từ 50 - 70m²</a>
                        </div>
                        <div class="col-6">
                            <a href="@Url.Action("Index", new { minPrice = ViewBag.CurrentMinPrice, maxPrice = ViewBag.CurrentMaxPrice, minArea = 70, maxArea = 90 })" class="sidebar-filter-link">Từ 70 - 90m²</a>
                        </div>
                        <div class="col-6">
                            <a href="@Url.Action("Index", new { minPrice = ViewBag.CurrentMinPrice, maxPrice = ViewBag.CurrentMaxPrice, minArea = 90, maxArea = (int?)null })" class="sidebar-filter-link">Trên 90m²</a>
                        </div>
                    </div>

                </div>
            </div>

            <div class="card mb-3">
                <div class="card-header fw-bold">Tin mới đăng</div>
                <div class="list-group list-group-flush">

                    @{
                        // Lấy danh sách từ ViewBag
                        var newestPosts = ViewBag.NewestPosts as List<QuanLyPhongTro.Models.Phong_Tro>;
                    }

                    @if (newestPosts != null && newestPosts.Any())
                    {
                        foreach (var item in newestPosts) // Lặp qua danh sách 10 tin mới
                        {
                            var hinhAnhDauTien = item.Hinh_Anh.Any()
                                ? Url.Content("~/Kho/Img/" + item.Hinh_Anh.First().Url_Anh)
                                : Url.Content("~/Kho/Img/placeholder.jpg");

                            <a href="@Url.Action("ChiTiet", "Home", new { id = item.ID_Phong_Tro })" class="list-group-item list-group-item-action">
                                <div class="row g-2 align-items-center">
                                    <div class="col-4">
                                        <img src="@hinhAnhDauTien" class="img-fluid rounded" alt="@item.Ten_Phong">
                                    </div>
                                    <div class="col-8">
                                        <h6 class="mb-1 text-primary title-clamp-2">
                                            @item.Ten_Phong
                                        </h6>
                                        <strong class="text-success d-block fw-bold">
                                            @(item.Gia_Ca.HasValue ? string.Format("{0:0.#} triệu/tháng",(decimal)item.Gia_Ca.Value/1_000_000M) : "Thỏa thuận")
                                        </strong>
                                        <small class="text-muted">
                                            @(item.Ngay_Dang.HasValue ? item.Ngay_Dang.Value.ToString("dd/MM/yyyy") : "...")
                                        </small>
                                    </div>
                                </div>
                            </a>
                        }
                    }
                    else
                    {
                        <div class="list-group-item">Chưa có tin đăng nào.</div>
                    }
                </div>
            </div>

        </div>
    </div>
</div>
@section Scripts {
    <script>
        $(document).ready(function () {

            // Lắng nghe sự kiện click trên TẤT CẢ các nút có class .btn-favorite
            $('.btn-favorite').on('click', function (e) {
                e.preventDefault(); // Ngăn trình duyệt nhảy lên đầu trang

                var $this = $(this); // Nút trái tim vừa được click
                var postId = $this.data('post-id'); // Lấy ID của phòng trọ

                // Gửi yêu cầu AJAX đến Controller
                $.ajax({
                    type: "POST",
                    url: "@Url.Action("ToggleFavorite", "Home")", // Sửa "Home" thành tên Controller của bạn
                    data: { id: postId },
                    success: function (data) {
                        // Khi Controller trả về kết quả thành công
                        if (data.success) {
                            if (data.isFavorited) {
                                // 1. ĐỔI SANG ĐÃ THÍCH
                                $this.addClass('active');
                                $this.find('i').removeClass('bi-heart').addClass('bi-heart-fill');
                            } else {
                                // 2. ĐỔI SANG BỎ THÍCH
                                $this.removeClass('active');
                                $this.find('i').removeClass('bi-heart-fill').addClass('bi-heart');
                            }
                        }
                    },
                    error: function (xhr, status, error) {
                        // Khi Controller trả về lỗi (như 401 - chưa đăng nhập)
                        if (xhr.status == 401 || (xhr.responseJSON && !xhr.responseJSON.success)) {
                            alert("Bạn cần đăng nhập để thực hiện việc này.");
                            // Tùy chọn: Chuyển hướng đến trang đăng nhập
                            // window.location.href = "@Url.Action("Login", "Account")";
                        } else {
                            alert("Đã xảy ra lỗi. Vui lòng thử lại.");
                        }
                    }
                });
            });
        });
    </script>
}
<section class="mt-4">
    <div class="bg-white rounded-3 border p-4 p-md-5">
        <h5 class="text-center fw-bold mb-4">CHO THUÊ PHÒNG TRỌ, NHÀ TRỌ</h5>

        <p>
            Khi có nhu cầu <a href="#" class="text-decoration-none">thuê phòng trọ</a>, chắc hẳn bạn sẽ băn khoăn với hàng loạt câu hỏi như:
            “Không biết bắt đầu từ đâu? Sợ bị mất cọc oan vì những phòng trọ <em>ảo</em>? Tìm mãi nhưng không ra phòng ưng ý?...”
        </p>

        <p>
            Đừng quá lo lắng, vì <strong>Phongtro123.com</strong> chính là giải pháp tối ưu dành cho những vấn đề đó.
            Nơi bạn có thể <strong>tìm phòng trọ</strong> mà không cần lặn lội khắp nơi, chỉ cần vài cú nhấp chuột là tìm thấy ngay một nơi ở tiềm năng.
        </p>

        <h6 class="fw-bold mt-4">Giới thiệu về Phongtro123.com</h6>
        <p>
            Phongtro123.com là kênh thông tin Phòng trọ số 1 Việt Nam, một nền tảng chuyên biệt về cho thuê phòng trọ, nhà trọ lớn nhất hiện nay.
            Được ra đời năm 2015 với tôn chỉ mang đến trải nghiệm tìm thuê, đăng tin cho thuê tối ưu cho người dùng.
            Với hơn <strong>130.000+</strong> chủ nhà và môi giới, <strong>200.000+</strong> tin đăng, <strong>1.000+</strong> tin mới mỗi ngày và
            hơn <strong>3.000.000+</strong> lượt truy cập mỗi tháng.
        </p>

        <h6 class="fw-bold mt-4">Ưu điểm của website Phongtro123.com</h6>
        <ol class="ps-3">
            <li class="mb-2"><strong>Tập trung chuyên môn</strong> cho mảng phòng trọ – nhà trọ, đảm bảo dữ liệu chất lượng, tin đăng rõ ràng.</li>
            <li class="mb-2"><strong>Bộ lọc thông minh</strong> theo khu vực, giá, diện tích, tiện ích… giúp rút ngắn thời gian tìm kiếm.</li>
            <li class="mb-2"><strong>Bảo vệ người dùng</strong> với các cảnh báo, ghi chú an toàn, hạn chế tình trạng lừa đảo đặt cọc.</li>
            <li class="mb-2"><strong>Đăng tin hiệu quả</strong> cho chủ nhà – môi giới: tiếp cận lượng người tìm phòng lớn mỗi ngày.</li>
        </ol>

        <h6 class="fw-bold mt-4">Dịch vụ nổi bật trên Phongtro123.com</h6>
        <ul class="ps-3">
            <li class="mb-2">Tin thường, tin VIP với vị trí hiển thị nổi bật giúp tăng lượng tiếp cận và số cuộc gọi.</li>
            <li class="mb-2">Đẩy tin, gia hạn tin, gợi ý tối ưu nội dung – hình ảnh để tăng tỉ lệ chuyển đổi.</li>
            <li class="mb-2">Hỗ trợ nhanh qua điện thoại/Zalo nếu bạn cần tư vấn đăng tin.</li>
        </ul>

        <p class="mb-0">
            Tìm hiểu thêm:
            <a href="#" class="text-decoration-none">Quy định đăng tin</a>,
            <a href="#" class="text-decoration-none">Bảng giá dịch vụ</a>,
            <a href="#" class="text-decoration-none">Câu hỏi thường gặp</a>.
        </p>
    </div>

    <!-- ===== WHY CHOOSE (METRICS) ===== -->
    <div class="bg-white rounded-3 border p-4 p-md-5 mt-3">
        <h5 class="text-center fw-bold mb-3">Tại sao lại chọn Phongtro123.com?</h5>
        <p class="text-center text-muted mb-4">
            Chúng tôi tự hào là trang web đứng top Google về các từ khóa cho thuê phòng trọ, nhà trọ,
            cho thuê căn hộ… với lưu lượng truy cập lớn, ổn định và chất lượng.
        </p>

        <div class="row g-3 g-md-4 text-center">
            <div class="col-6 col-md-3">
                <div class="border rounded-3 p-3 h-100">
                    <div class="fw-bold fs-5">130.000+</div>
                    <div class="text-muted small">Chủ nhà &amp; Môi giới</div>
                </div>
            </div>
            <div class="col-6 col-md-3">
                <div class="border rounded-3 p-3 h-100">
                    <div class="fw-bold fs-5">200.000+</div>
                    <div class="text-muted small">Tin đăng</div>
                </div>
            </div>
            <div class="col-6 col-md-3">
                <div class="border rounded-3 p-3 h-100">
                    <div class="fw-bold fs-5">1.000+</div>
                    <div class="text-muted small">Tin đăng/ngày</div>
                </div>
            </div>
            <div class="col-6 col-md-3">
                <div class="border rounded-3 p-3 h-100">
                    <div class="fw-bold fs-5">3.000.000+</div>
                    <div class="text-muted small">Lượt xem/tháng</div>
                </div>
            </div>
        </div>

        <div class="text-center mt-4">
            <div class="small text-muted mb-2">Chi phí thấp, hiệu quả tối đa</div>
            <a href="@Url.Action("DangTin","User")" class="btn btn-warning fw-semibold px-4">
                <i class="bi bi-pencil-square me-1"></i> Đăng tin ngay
            </a>
        </div>
    </div>
</section>
<section class="pt-support">
    <div class="wrap">
        <!-- Hình minh họa trái -->
        <div class="art">
            <!-- thay ảnh theo ý bạn -->
            <img src="~/Assets/Images/imgbanggia/dangtin.jpg" alt="Hỗ trợ đăng tin">
        </div>

        <!-- Nội dung phải -->
        <div>
            <div class="head">
                <div class="icon">🎧</div>
                <h3>Hỗ trợ chủ nhà đăng tin</h3>
                <div class="lead">Nếu bạn cần hỗ trợ đăng tin, vui lòng liên hệ số điện thoại bên dưới:</div>
            </div>

            <div class="btns">
                <!-- Điện thoại -->
                <a class="btn phone" href="tel:0909316890">
                    <span class="ic">
                        <!-- phone svg -->
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M6.62 10.79a15.05 15.05 0 006.59 6.59l2.2-2.2a1 1 0 011.02-.24 11.36 11.36 0 003.56.57 1 1 0 011 1v3.61a1 1 0 01-1 1A17 17 0 013 5a1 1 0 011-1h3.61a1 1 0 011 1 11.36 11.36 0 00.57 3.56 1 1 0 01-.24 1.02l-2.32 2.21z" /></svg>
                    </span>
                    ĐT: 0909316890
                </a>

                <!-- Zalo trực tiếp số -->
                <a class="btn zalo" href="https://zalo.me/0909316890" target="_blank" rel="noopener">
                    <span class="ic">
                        <!-- chat bubble svg -->
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20 2H4a2 2 0 00-2 2v18l4-4h14a2 2 0 002-2V4a2 2 0 00-2-2z" /></svg>
                    </span>
                    Zalo: 0909316890
                </a>
            </div>

            <div class="sub">Hỗ trợ ngoài giờ</div>

            <div class="btns">
                <!-- Zalo OA -->
                <a class="btn zalo" href="https://zalo.me/Phongtro123" target="_blank" rel="noopener">
                    <span class="ic">
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20 2H4a2 2 0 00-2 2v18l4-4h14a2 2 0 002-2V4a2 2 0 00-2-2z" /></svg>
                    </span>
                    Zalo: Phongtro123
                </a>
            </div>
        </div>
    </div>

</section>
